---
title: "Diabetes Final Project - Stats 115"
format: revealjs
editor: visual
execute:
  echo: false
html:
include-in-header:
      - text: |
          <script src = "https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js""></script>
          <script type="text/javascript">
            $(document).ready(function() {
              $('body').prepend('<div class=\"zoomDiv\"><img src=\"\" class=\"zoomImg\"></div>');
              // onClick function for all plots (img's)
              $('img:not(.zoomImg)').click(function() {
                $('.zoomImg').attr('src', $(this).attr('src')).css({width: '100%'});
                $('.zoomDiv').css({opacity: '1', width: 'auto', border: '1px solid white', borderRadius: '5px', position: 'fixed', top: '50%', left: '50%', marginRight: '-50%', transform: 'translate(-50%, -50%)', boxShadow: '0px 0px 50px #888888', zIndex: '50', overflow: 'auto', maxHeight: '100%'});
              });
              // onClick function for zoomImg
              $('img.zoomImg').click(function() {
                $('.zoomDiv').css({opacity: '0', width: '0%'}); 
              });
            });
          </script>
---

```{r}
# Load packages
library(bayesrules)
library(tidyverse)
library(rstanarm)
library(bayesplot)
library(tidybayes)
library(broom.mixed)
library(forcats)
library(Hmisc)
library(corrplot)

```

## Introduction

Diabetes is a chronic disease that occurs when the pancreas does not produce insulin, or when the body develops insulin resistance, and cannot effectively control blood sugar. This can be classified into two major types, commonly known as Type 1 or Type 2 Diabetes. Both types and their causes are still undetermined; however in Type 2's case, scientists have been able to infer that general health and exercise activity may contribute to its cause.

------------------------------------------------------------------------

With 29.7 million people of all ages – approximately 8.9% of the US population diagnosed with diabetes, it's fairly important to consider the impact diabetes has caused on the day-to-day aspects of patients. Our analysis aims to better understand this impact and the causes of diabetes by using Bayesian statistical analysis to determine correlations between diabetes and lifestyle factors.

------------------------------------------------------------------------

## Data

Our statistical analysis utilizes the CDC's dataset on Diabetes Health Indicators. It contains 35 features on healthcare statistics and lifestyle survey information of US citizens, along with their diagnosis of diabetes. We determine our response variable in our study to be Diabetes_binary, a variable that classifies whether or not a citizen has diabetes.

```{r}
df <- read.csv("./data/binary_diabetes.csv")
#sample_n(df, 3)
#nrow(df)
```

------------------------------------------------------------------------

```{r}
df_orig <- df
cols <- c("Diabetes_binary","HighBP","HighChol","CholCheck","Smoker","Stroke","HeartDiseaseorAttack","PhysActivity","Fruits","Veggies","HvyAlcoholConsump","AnyHealthcare","NoDocbcCost","DiffWalk","Sex")
df[cols] <- lapply(df[cols], factor) 
```

Conducting preliminary analysis on the dataset shows us some insights; first, creating a correlation matrix allow us to see what features positively correlate with our response, Diabetes_binary.

```{r fig.height=7, fig.width=7, dpi=500}
cor_mtx <- cor(df_orig)
corrplot(cor_mtx, type="upper", order = "hclust", tl.cex = 0.6, )
```

------------------------------------------------------------------------

Based on our matrix, we can observe that BMI, DiffWalk, GenHealth, PhysHealth, HighChol, HighBP, Age, and HeartDiseaseorAttack are positively correlated with Diabetes_binary.

------------------------------------------------------------------------

A bar graph of Diabetes_binary allows us to observe the count of those with diabetes and without in the dataset. We can also observe the imbalance of data for Diabetes_binary – a note to keep in mind when conducting our model analysis.

```{r}
ggplot(df, aes(x=Diabetes_binary)) +
  geom_bar() +
  theme_light() +
  labs(title="Diabetes")
```

We select HighBP, HighChol, HeartDiseaseorAttack, and PhysActivity as our main variables of interest towards our response Diabetes_binary. Our feature selection will be explained as we delve into our model selection.

------------------------------------------------------------------------

## Model Selection

### Diabetes_binary \~ HeartAttackorDisease

-   We developed an informative prior of normal(0.7793, 0.028) to deduce if our selected feature, HeartAttackorDisease, shows quantifiable evidence of statistical correlation beyond the correlation matrix with our response Diabetes_binary.

------------------------------------------------------------------------

-   Based on conducted research, we found that those with diabetes have twice the odds of contracting heart disease or attacks. More specifically, we sourced that the odds ratios associated with self-reported diabetes for prevalent ischemic heart attack to be 2.18, with a 95% confidence interval of (2.06, 2.30).
-   Although using an odds ratio may not be preferred over odds since it is only a relative measure, we found it to be the most accurate information for our prior since most research articles would provide vaguer evidence of the relationship between diabetes and heart disease.

------------------------------------------------------------------------

## Model Results

------------------------------------------------------------------------

## Reflection on Results

-   The result of our study highlighted the effect of blood pressure, cholesterol level, history of heart disease, and the level of physical activity on diabetes.
-   Our model is fair because it helps people predict if someone might have diabetes.
-   Our study can be used as a building block for future studies.

------------------------------------------------------------------------

### Limitations

-   All of the variables we chose are binary.
-   Using continuous variable may give more precise predictions.
-   EX: 1 unit or 10 units above high blood pressure cutoff point.

## Sources
